<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      th:replace="layout/layout :: html(~{::section}, ${property.name})">

<section class="detail-page">

  <!-- detail 전용 CSS -->
  <link rel="stylesheet" th:href="@{/css/detail.css}"/>

  <!-- ✅ main.html과 동일한 4/8 레이아웃 -->
  <div class="container-fluid px-0">
    <div class="row g-0 app-main">

      <!-- LEFT (main과 동일: col-md-4 / list-panel) -->
      <aside class="col-md-4 list-panel detail-panel">
        <!-- main의 list-scroll 느낌으로 스크롤 -->
        <div class="detail-scroll">

          <div class="panel">

            <div class="hero">
              <div class="heroTop">
                <div>
                  <h1 class="title" th:text="${property.name}">서울 관악구 신림동 원룸</h1>
                  <p class="price" th:text="${property.price}">보증금 1000 / 월세 45</p>
                </div>

                <div class="actions">
                  <button class="iconBtn" id="btnHeart" type="button" title="위시리스트">
                    <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                      <path d="M12 21s-7-4.7-9.5-9.1C.3 8.2 2.1 5.2 5.4 4.4c1.9-.4 3.8.2 5 1.6 1.2-1.4 3.1-2 5-1.6 3.3.8 5.1 3.8 2.9 7.5C19 16.3 12 21 12 21z"
                            stroke="#0F172A" stroke-width="1.6"/>
                    </svg>
                  </button>

                  <button class="iconBtn" id="btnShare" type="button" title="공유">
                    <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                      <path d="M16 8a3 3 0 1 0-2.8-4" stroke="#0F172A" stroke-width="1.6" stroke-linecap="round"/>
                      <path d="M8 12l8-4" stroke="#0F172A" stroke-width="1.6" stroke-linecap="round"/>
                      <path d="M8 12l8 4" stroke="#0F172A" stroke-width="1.6" stroke-linecap="round"/>
                      <path d="M8 14a3 3 0 1 1 0-4" stroke="#0F172A" stroke-width="1.6" stroke-linecap="round"/>
                      <path d="M16 20a3 3 0 1 0 0-4" stroke="#0F172A" stroke-width="1.6" stroke-linecap="round"/>
                    </svg>
                  </button>
                </div>
              </div>

              <div class="chips">
                <span class="chip">🏠 <span th:text="${property.type}">원룸</span></span>
                <span class="chip">📐 <span th:text="${property.area}">18㎡</span></span>
                <span class="chip">📍 위치 기반 분석</span>
              </div>
            </div>

            <div class="section">
              <div class="photo">
                <div class="photoTag">대충 사진</div>
                <div class="photoHint">사진 1/1</div>
              </div>
            </div>

            <div class="section">
              <h3>기본 정보</h3>
              <div class="kv">
                <div class="k">유형</div><div class="v" th:text="${property.type}">원룸</div>
                <div class="k">면적</div><div class="v" th:text="${property.area}">18㎡</div>
                <div class="k">주소</div><div class="v" th:text="${property.address}">서울특별시 관악구 신림동 123-45</div>
              </div>
            </div>

            <div class="section">
              <h3>치안 정보</h3>

              <div class="safetyRow">
                <div class="scoreCard">
                  <div class="scoreTop">
                    <div class="scoreLabel">안전 점수</div>
                    <div class="badge" th:text="${property.safetyScore + '점'}">78점</div>
                  </div>
                  <div class="mini">주변 치안/시설 데이터를 종합해 점수화했어요.</div>
                  <div class="barWrap">
                    <div class="bar" th:style="'width:' + ${property.safetyScore} + '%;'"></div>
                  </div>
                </div>
              </div>

              <div class="list">
                <div class="item">
                  <div>
                    <b>📹 CCTV (300m)</b>
                    <div class="muted">반경 300m 이내</div>
                  </div>
                  <div class="badge" th:text="${property.cctvCount + '개'}">21개</div>
                </div>

                <div class="item">
                  <div>
                    <b>🌙 여성안심귀갓길</b>
                    <div class="muted">가장 가까운 구간</div>
                  </div>
                  <div class="badge" th:text="${property.safeRoadDistance + 'm'}">320m</div>
                </div>
              </div>
            </div>

            <div class="section">
              <h3>생활 인프라</h3>

              <div class="grid2">
                <div class="infraCard">
                  <div class="infraTop">
                    <div class="infraTitle">🚇 지하철</div>
                    <div class="pill good">좋음</div>
                  </div>
                  <div class="infraSub">가장 가까운 역 650m</div>
                </div>

                <div class="infraCard">
                  <div class="infraTop">
                    <div class="infraTitle">🏪 편의점</div>
                    <div class="pill good">좋음</div>
                  </div>
                  <div class="infraSub">반경 300m 내 5개</div>
                </div>

                <div class="infraCard">
                  <div class="infraTop">
                    <div class="infraTitle">🏥 병원</div>
                    <div class="pill">보통</div>
                  </div>
                  <div class="infraSub">반경 1km 내 3개</div>
                </div>

                <div class="infraCard">
                  <div class="infraTop">
                    <div class="infraTitle">🛒 마트</div>
                    <div class="pill warn">아쉬움</div>
                  </div>
                  <div class="infraSub">반경 1km 내 1개</div>
                </div>
              </div>
            </div>

          </div><!-- /.panel -->
        </div><!-- /.detail-scroll -->
      </aside>

      <!-- RIGHT (main과 동일: col-md-8 / map-wrap / map-container) -->
      <section class="col-md-8 map-wrap detail-map-wrap">
        <div id="detailMap" class="map-container"></div>

        <div class="fab-stack">
          <button class="btn btn-light fab fab-noti" type="button" aria-label="알림">
            <i class="bi bi-bell"></i>
            <span class="noti-dot" aria-hidden="true"></span>
          </button>

          <button class="btn btn-light fab" type="button" aria-label="최근 기록">
            <i class="bi bi-clock"></i>
          </button>
        </div>
      </section>

    </div>
  </div>

  <div class="toast" id="toast">복사됨</div>

  <script th:inline="javascript">
    window.__DETAIL__ = { lat: [[${property.lat}]], lng: [[${property.lng}]] };
  </script>

  <script th:src="|//dapi.kakao.com/v2/maps/sdk.js?appkey=${kakaoJsKey}|"></script>
  <script th:src="@{/js/detail.js}"></script>

</section>
</html>