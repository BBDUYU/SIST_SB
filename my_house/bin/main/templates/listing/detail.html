<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title th:text="${property.name}">ìƒì„¸ë³´ê¸°</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Kakao Map -->
  <script th:src="|//dapi.kakao.com/v2/maps/sdk.js?appkey=${kakaoJsKey}|"></script>

  <style>
    :root{
      --brand:#1E3A8A;
      --bg:#F6F8FB;
      --card:#FFFFFF;
      --line:#E7ECF3;
      --text:#0F172A;
      --muted:#64748B;
      --chip:#EEF2FF;
      --danger:#DC2626;
      --good:#16A34A;
      --shadow:0 8px 30px rgba(15,23,42,.06);
      --shadow2:0 8px 30px rgba(15,23,42,.08);
      --r16:16px;
      --r14:14px;
      --r12:12px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial;color:var(--text);background:var(--bg)}
    a{color:inherit;text-decoration:none}
    .container{display:flex;height:100vh;gap:12px;padding:12px}

    /* left / right */
    .left{width:420px;min-width:360px;max-width:480px;overflow:auto}
    .right{flex:1;border-radius:var(--r16);overflow:hidden;box-shadow:var(--shadow2);background:#fff;position:relative}
    .map{width:100%;height:100%}

    /* panel */
    .panel{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--r16);
      box-shadow:var(--shadow);
      overflow:hidden;
    }

    /* hero header */
    .hero{
      padding:18px 18px 14px 18px;
      border-bottom:1px solid var(--line);
      background:linear-gradient(180deg, rgba(30,58,138,.10), rgba(255,255,255,0));
    }
    .heroTop{display:flex;align-items:flex-start;justify-content:space-between;gap:12px}
    .title{font-size:18px;font-weight:900;letter-spacing:-0.3px;margin:0 0 6px}
    .price{font-size:15px;font-weight:800;color:var(--brand);margin:0 0 10px}

    .actions{display:flex;gap:8px}
    .iconBtn{
      width:38px;height:38px;border-radius:12px;
      border:1px solid var(--line);
      background:#fff; box-shadow:0 3px 12px rgba(15,23,42,.06);
      display:inline-flex;align-items:center;justify-content:center;
      cursor:pointer; user-select:none;
      transition:.15s transform ease, .15s background ease, .15s border ease;
    }
    .iconBtn:hover{transform:translateY(-1px)}
    .iconBtn.hearted{border-color:rgba(220,38,38,.25);background:rgba(220,38,38,.06)}
    .iconBtn svg{width:18px;height:18px}
    .iconBtn.hearted svg path{fill:var(--danger);stroke:var(--danger)}

    .chips{display:flex;flex-wrap:wrap;gap:8px}
    .chip{
      display:inline-flex;align-items:center;gap:6px;
      padding:6px 10px;border-radius:999px;
      background:var(--chip);color:var(--brand);
      font-size:12px;font-weight:800;border:1px solid rgba(30,58,138,.12);
    }

    /* sections */
    .section{padding:14px 18px;border-bottom:1px solid var(--line)}
    .section:last-child{border-bottom:0}
    .section h3{margin:0 0 10px;font-size:13px;color:var(--muted);font-weight:900;letter-spacing:-0.2px}

    .kv{display:grid;grid-template-columns:74px 1fr;row-gap:8px;column-gap:10px;font-size:13px}
    .k{color:var(--muted);font-weight:800}
    .v{font-weight:800}

    /* photo */
    .photo{
      width:100%;
      height:180px;
      border-radius:14px;
      background:
        linear-gradient(135deg, rgba(30,58,138,.18), rgba(255,255,255,0)),
        url('https://images.unsplash.com/photo-1505691938895-1758d7feb511?auto=format&fit=crop&w=1200&q=60');
      background-size:cover;
      background-position:center;
      border:1px solid var(--line);
      overflow:hidden;
      position:relative;
      box-shadow:0 6px 18px rgba(15,23,42,.08);
    }
    .photoTag{
      position:absolute;left:12px;top:12px;
      background:rgba(15,23,42,.72);
      color:#fff;font-weight:900;font-size:12px;
      padding:6px 10px;border-radius:999px;
      backdrop-filter: blur(6px);
    }
    .photoHint{
      position:absolute;right:12px;bottom:12px;
      background:rgba(255,255,255,.86);
      color:var(--text);
      font-weight:900;font-size:12px;
      padding:6px 10px;border-radius:999px;
      border:1px solid rgba(231,236,243,.9);
    }

    /* safety cards */
    .safetyRow{display:flex;gap:10px;align-items:stretch}
    .scoreCard{
      flex:1; padding:12px; border-radius:14px;
      border:1px solid var(--line); background:#fff;
    }
    .scoreTop{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
    .scoreLabel{font-size:12px;color:var(--muted);font-weight:900}
    .badge{
      background:var(--brand);color:#fff;
      font-size:12px;font-weight:900;
      padding:6px 10px;border-radius:999px;
    }
    .mini{font-size:12px;color:var(--muted);font-weight:800;line-height:1.4}
    .barWrap{height:8px;background:#EAF0FF;border-radius:999px;overflow:hidden;margin-top:10px}
    .bar{height:100%;background:var(--brand);width:0%}

    .list{display:flex;flex-direction:column;gap:10px;margin-top:10px}
    .item{
      display:flex;justify-content:space-between;align-items:center;
      padding:10px 12px;border:1px solid var(--line);
      border-radius:12px;background:#fff
    }
    .item b{font-size:13px}
    .muted{color:var(--muted);font-size:12px;font-weight:800}

    /* infra grid */
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .infraCard{
      border:1px solid var(--line);border-radius:14px;background:#fff;
      padding:12px; display:flex;flex-direction:column;gap:8px;
    }
    .infraTop{display:flex;justify-content:space-between;align-items:center}
    .infraTitle{font-weight:900;font-size:13px}
    .pill{
      font-size:12px;font-weight:900;border-radius:999px;padding:6px 10px;
      border:1px solid var(--line);background:#fff;color:var(--text);
    }
    .pill.good{border-color:rgba(22,163,74,.25);background:rgba(22,163,74,.08);color:var(--good)}
    .pill.warn{border-color:rgba(220,38,38,.25);background:rgba(220,38,38,.06);color:var(--danger)}
    .infraSub{font-size:12px;color:var(--muted);font-weight:800}

    /* floating map buttons */
    .mapFabWrap{position:absolute;right:14px;bottom:14px;display:flex;flex-direction:column;gap:10px}
    .fab{
      width:44px;height:44px;border-radius:14px;border:1px solid var(--line);background:#fff;
      box-shadow:0 10px 20px rgba(15,23,42,.12);
      display:flex;align-items:center;justify-content:center;
      cursor:pointer;
    }
    .fab svg{width:18px;height:18px}
    .toast{
      position:fixed;left:50%;bottom:18px;transform:translateX(-50%);
      background:rgba(15,23,42,.85);color:#fff;
      padding:10px 12px;border-radius:12px;font-weight:900;font-size:12px;
      opacity:0;pointer-events:none;transition:.2s opacity ease;
    }
    .toast.show{opacity:1}
  </style>
</head>
<body>

<div class="container">

  <!-- LEFT -->
  <div class="left">
    <div class="panel">

      <div class="hero">
        <div class="heroTop">
          <div>
            <h1 class="title" th:text="${property.name}">ì„œìš¸ ê´€ì•…êµ¬ ì‹ ë¦¼ë™ ì›ë£¸</h1>
            <p class="price" th:text="${property.price}">ë³´ì¦ê¸ˆ 1000 / ì›”ì„¸ 45</p>
          </div>

          <div class="actions">
            <!-- wishlist -->
            <button class="iconBtn" id="btnHeart" type="button" title="ìœ„ì‹œë¦¬ìŠ¤íŠ¸">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M12 21s-7-4.7-9.5-9.1C.3 8.2 2.1 5.2 5.4 4.4c1.9-.4 3.8.2 5 1.6 1.2-1.4 3.1-2 5-1.6 3.3.8 5.1 3.8 2.9 7.5C19 16.3 12 21 12 21z" stroke="#0F172A" stroke-width="1.6"/>
              </svg>
            </button>

            <!-- share -->
            <button class="iconBtn" id="btnShare" type="button" title="ê³µìœ ">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M16 8a3 3 0 1 0-2.8-4" stroke="#0F172A" stroke-width="1.6" stroke-linecap="round"/>
                <path d="M8 12l8-4" stroke="#0F172A" stroke-width="1.6" stroke-linecap="round"/>
                <path d="M8 12l8 4" stroke="#0F172A" stroke-width="1.6" stroke-linecap="round"/>
                <path d="M8 14a3 3 0 1 1 0-4" stroke="#0F172A" stroke-width="1.6" stroke-linecap="round"/>
                <path d="M16 20a3 3 0 1 0 0-4" stroke="#0F172A" stroke-width="1.6" stroke-linecap="round"/>
              </svg>
            </button>
          </div>
        </div>

        <div class="chips">
          <span class="chip">ğŸ  <span th:text="${property.type}">ì›ë£¸</span></span>
          <span class="chip">ğŸ“ <span th:text="${property.area}">18ã¡</span></span>
          <span class="chip">ğŸ“ ìœ„ì¹˜ ê¸°ë°˜ ë¶„ì„</span>
        </div>
      </div>

      <div class="section">
        <div class="photo">
          <div class="photoTag">ëŒ€ì¶© ì‚¬ì§„</div>
          <div class="photoHint">ì‚¬ì§„ 1/1</div>
        </div>
      </div>

      <div class="section">
        <h3>ê¸°ë³¸ ì •ë³´</h3>
        <div class="kv">
          <div class="k">ìœ í˜•</div><div class="v" th:text="${property.type}">ì›ë£¸</div>
          <div class="k">ë©´ì </div><div class="v" th:text="${property.area}">18ã¡</div>
          <div class="k">ì£¼ì†Œ</div><div class="v" th:text="${property.address}">ì„œìš¸íŠ¹ë³„ì‹œ ê´€ì•…êµ¬ ì‹ ë¦¼ë™ 123-45</div>
        </div>
      </div>

      <div class="section">
        <h3>ì¹˜ì•ˆ ì •ë³´</h3>

        <div class="safetyRow">
          <div class="scoreCard">
            <div class="scoreTop">
              <div class="scoreLabel">ì•ˆì „ ì ìˆ˜</div>
              <div class="badge" th:text="${property.safetyScore + 'ì '}">78ì </div>
            </div>
            <div class="mini">ì£¼ë³€ ì¹˜ì•ˆ/ì‹œì„¤ ë°ì´í„°ë¥¼ ì¢…í•©í•´ ì ìˆ˜í™”í–ˆì–´ìš”.</div>
            <div class="barWrap">
              <div class="bar" th:style="'width:' + ${property.safetyScore} + '%;'"></div>
            </div>
          </div>
        </div>

        <div class="list">
          <div class="item">
            <div>
              <b>ğŸ“¹ CCTV (300m)</b>
              <div class="muted">ë°˜ê²½ 300m ì´ë‚´</div>
            </div>
            <div class="badge" th:text="${property.cctvCount + 'ê°œ'}">21ê°œ</div>
          </div>

          <div class="item">
            <div>
              <b>ğŸŒ™ ì—¬ì„±ì•ˆì‹¬ê·€ê°“ê¸¸</b>
              <div class="muted">ê°€ì¥ ê°€ê¹Œìš´ êµ¬ê°„</div>
            </div>
            <div class="badge" th:text="${property.safeRoadDistance + 'm'}">320m</div>
          </div>
        </div>
      </div>

      <div class="section">
        <h3>ìƒí™œ ì¸í”„ë¼</h3>

        <!-- ë”ë¯¸ ì¸í”„ë¼ ë°ì´í„° (ë‚˜ì¤‘ì— API ë¶™ì´ë©´ ë¨) -->
        <div class="grid2">
          <div class="infraCard">
            <div class="infraTop">
              <div class="infraTitle">ğŸš‡ ì§€í•˜ì² </div>
              <div class="pill good">ì¢‹ìŒ</div>
            </div>
            <div class="infraSub">ê°€ì¥ ê°€ê¹Œìš´ ì—­ 650m</div>
          </div>

          <div class="infraCard">
            <div class="infraTop">
              <div class="infraTitle">ğŸª í¸ì˜ì </div>
              <div class="pill good">ì¢‹ìŒ</div>
            </div>
            <div class="infraSub">ë°˜ê²½ 300m ë‚´ 5ê°œ</div>
          </div>

          <div class="infraCard">
            <div class="infraTop">
              <div class="infraTitle">ğŸ¥ ë³‘ì›</div>
              <div class="pill">ë³´í†µ</div>
            </div>
            <div class="infraSub">ë°˜ê²½ 1km ë‚´ 3ê°œ</div>
          </div>

          <div class="infraCard">
            <div class="infraTop">
              <div class="infraTitle">ğŸ›’ ë§ˆíŠ¸</div>
              <div class="pill warn">ì•„ì‰¬ì›€</div>
            </div>
            <div class="infraSub">ë°˜ê²½ 1km ë‚´ 1ê°œ</div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- RIGHT (MAP) -->
  <div class="right">
    <div id="map" class="map"></div>

    <div class="mapFabWrap">
      <button class="fab" id="btnMyPos" type="button" title="ë‚´ ìœ„ì¹˜(ë”ë¯¸)">
        <svg viewBox="0 0 24 24" fill="none">
          <path d="M12 2v3" stroke="#0F172A" stroke-width="1.6" stroke-linecap="round"/>
          <path d="M12 19v3" stroke="#0F172A" stroke-width="1.6" stroke-linecap="round"/>
          <path d="M2 12h3" stroke="#0F172A" stroke-width="1.6" stroke-linecap="round"/>
          <path d="M19 12h3" stroke="#0F172A" stroke-width="1.6" stroke-linecap="round"/>
          <circle cx="12" cy="12" r="4.2" stroke="#0F172A" stroke-width="1.6"/>
        </svg>
      </button>

      <button class="fab" id="btnRecenter" type="button" title="ë§¤ë¬¼ ìœ„ì¹˜ë¡œ">
        <svg viewBox="0 0 24 24" fill="none">
          <path d="M12 21s7-4.7 9.5-9.1C23.7 8.2 21.9 5.2 18.6 4.4c-1.9-.4-3.8.2-5 1.6-1.2-1.4-3.1-2-5-1.6C5.3 5.2 3.5 8.2 5.7 11.9 8 16.3 12 21 12 21z" stroke="#0F172A" stroke-width="1.6"/>
        </svg>
      </button>
    </div>
  </div>

</div>

<div class="toast" id="toast">ë³µì‚¬ë¨</div>

<script th:inline="javascript">
  // coords from model
  var lat = [[${property.lat}]];
  var lng = [[${property.lng}]];

  // Kakao map
  var mapContainer = document.getElementById('map');
  var center = new kakao.maps.LatLng(lat, lng);
  var map = new kakao.maps.Map(mapContainer, { center: center, level: 3 });

  var marker = new kakao.maps.Marker({ position: center });
  marker.setMap(map);

  // Wishlist toggle (dummy)
  var btnHeart = document.getElementById('btnHeart');
  btnHeart.addEventListener('click', function(){
    btnHeart.classList.toggle('hearted');
    toast(btnHeart.classList.contains('hearted') ? 'ìœ„ì‹œë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€' : 'ìœ„ì‹œë¦¬ìŠ¤íŠ¸ í•´ì œ');
  });

  // Share (copy URL)
  var btnShare = document.getElementById('btnShare');
  btnShare.addEventListener('click', async function(){
    try{
      await navigator.clipboard.writeText(window.location.href);
      toast('ë§í¬ ë³µì‚¬ë¨');
    }catch(e){
      // fallback
      var tmp = document.createElement('textarea');
      tmp.value = window.location.href;
      document.body.appendChild(tmp);
      tmp.select();
      document.execCommand('copy');
      document.body.removeChild(tmp);
      toast('ë§í¬ ë³µì‚¬ë¨');
    }
  });

  // Map buttons
  document.getElementById('btnRecenter').addEventListener('click', function(){
    map.setCenter(center);
    map.setLevel(3);
    toast('ë§¤ë¬¼ ìœ„ì¹˜ë¡œ ì´ë™');
  });

  document.getElementById('btnMyPos').addEventListener('click', function(){
    // dummy: slightly move
    var my = new kakao.maps.LatLng(lat + 0.002, lng + 0.002);
    map.panTo(my);
    toast('ë‚´ ìœ„ì¹˜(ë”ë¯¸) ì´ë™');
  });

  // toast helper
  var toastEl = document.getElementById('toast');
  var toastTimer = null;
  function toast(msg){
    toastEl.textContent = msg;
    toastEl.classList.add('show');
    if(toastTimer) clearTimeout(toastTimer);
    toastTimer = setTimeout(()=>toastEl.classList.remove('show'), 1200);
  }
</script>

</body>
</html>